
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Acerte o Cora√ß√£o da Thay üíò</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Arial', sans-serif;
    margin: 0;
    padding: 0;
    overflow: hidden;
  }

  /* Fundo animado */
  .animated-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, #ff4081, #ff80ab, #69007f, #0ce39a);
    background-size: 400% 400%;
    animation: gradientAnimation 10s ease infinite;
    z-index: -1; /* Fica atr√°s de todo o conte√∫do */
  }

  @keyframes gradientAnimation {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  #menuScreen, #gameScreen {
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    width: 100%;
    color: white;
  }

  #menuScreen.active, #gameScreen.active, #gameOverScreen.active {
    display: flex;
  }

  #gameOverScreen {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  width: 100%;
  background: rgba(0, 0, 0, 0.8); /* Fundo escuro */
  color: white;
  text-align: center;
}

#resultContainer {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 20px; /* Espa√ßamento entre os elementos */
}

#finalScoreDisplay {
  font-size: 3em; /* Pontua√ß√£o grande no centro */
  font-weight: bold;
  color: #ff4081;
}

#thayImage {
  width: 150px;
  height: auto;
  animation: popIn 0.5s ease; /* Anima√ß√£o ao aparecer */
}

#loveLevelDisplay {
  font-size: 1.2em;
  background: rgba(255, 255, 255, 0.9);
  color: #333;
  padding: 10px 20px;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

#menuButton {
  position: absolute;
  bottom: 20px; /* Fica no final da tela */
  left: 50%;
  transform: translateX(-50%);
  display: none; /* Esconde o bot√£o por padr√£o */
}

#gameOverScreen.active #menuButton {
  display: block; /* Exibe o bot√£o apenas na tela de Game Over */
}

@keyframes popIn {
  0% {
    transform: scale(0.5);
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}
/* Estilo base para todos os bot√µes */
button {
  display: inline-block;
  outline: 0;
  border: 0;
  cursor: pointer;
  will-change: box-shadow, transform;
  padding: 10px 20px;
  border-radius: 12px;
  color: white;
  font-size: 1.2em;
  text-shadow: 0 1px 0 rgba(0, 0, 0, 0.4);
  transition: box-shadow 0.15s ease, transform 0.15s ease;
  margin: 10px 0;
}

/* Bot√£o prim√°rio (azul) */
button.primary-button {
  background: radial-gradient(100% 100% at 100% 0%, #89E5FF 0%, #5468FF 100%);
  box-shadow: 0px 2px 4px rgba(45, 35, 66, 0.4), 0px 7px 13px -3px rgba(45, 35, 66, 0.3), inset 0px -3px 0px rgba(58, 65, 111, 0.5);
}

button.primary-button:hover {
  box-shadow: 0px 4px 8px rgba(45, 35, 66, 0.4), 0px 7px 13px -3px rgba(45, 35, 66, 0.3), inset 0px -3px 0px #3c4fe0;
  transform: translateY(-2px);
}

button.primary-button:active {
  box-shadow: inset 0px 3px 7px #3c4fe0;
  transform: translateY(2px);
}

/* Bot√£o secund√°rio (rosa) */
button.secondary-button {
  background: radial-gradient(100% 100% at 100% 0%, #FF89C1 0%, #FF4081 100%);
  box-shadow: 0px 2px 4px rgba(45, 35, 66, 0.4), 0px 7px 13px -3px rgba(255, 64, 129, 0.3), inset 0px -3px 0px rgba(255, 64, 129, 0.5);
}

button.secondary-button:hover {
  box-shadow: 0px 4px 8px rgba(45, 35, 66, 0.4), 0px 7px 13px -3px rgba(255, 64, 129, 0.3), inset 0px -3px 0px #e03c6f;
  transform: translateY(-2px);
}

button.secondary-button:active {
  box-shadow: inset 0px 3px 7px #e03c6f;
  transform: translateY(2px);
}

.modal-content ol {
  list-style: decimal inside; /* Exibe n√∫meros dentro da lista */
  margin: 0;
  padding: 0;
}

.modal-content li {
  margin: 8px 0; /* Espa√ßamento entre os itens */
  font-size: 1em; /* Tamanho da fonte */
  color: #333; /* Cor do texto */
}


    #gameArea {
      position: relative;
      width: 360px;
      height: 540px;
      background: rgba(255, 255, 255, 0.2); /* Transl√∫cido */

      border-radius: 12px;
      overflow: hidden;
      margin: 0 auto;
    }
        
    .heart {
      position: absolute;
      width: 50px;
      height: 50px;
      background-image: url('https://i.postimg.cc/JHDjHMPy/heart.gif');
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      cursor: pointer;
      filter: hue-rotate(0deg);
      animation: pulse 1.2s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }

    .floating-heart {
      position: absolute;
      width: 20px;
      height: 20px;
      background-image: url('https://i.postimg.cc/JHDjHMPy/heart.gif');
      background-size: cover;
      opacity: 0.5;
      animation: floatUp 6s linear infinite;
    }

    @keyframes floatUp {
      0% { transform: translateY(100vh) scale(0.8); opacity: 0.5; }
      100% { transform: translateY(-20vh) scale(1.2); opacity: 0; }
    }

    #score, #timer {
      margin: 10px;
      font-size: 1.2em;
    }

    .stats {
      font-size: 1.2em;
      text-align: center;
      margin-top: 15px;
    }

    #statsBox {
  display: flex;
  justify-content: space-evenly;
  align-items: flex-start;
  width: 360px;
  margin: 20px auto;
}

.stat {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  width: 150px; /* Largura de cada caixa */
  padding: 10px;
  background-color: rgba(255, 255, 255, 0.8);
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  position: relative;
}

.label {
  position: absolute;
  top: -20px;
  font-size: 0.8em;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: #d0d0d0;
  margin-bottom: 12px;
}

.value {
  font-size: 1.5em;
  font-weight: bold;
}

#score {
  color: #e01c5d; /* Cor para os pontos */
}

#timer {
  color: #6c1674; /* Cor para o tempo */
}

#timer.blink {
  animation: blink 0.5s step-start infinite;
}

@keyframes blink {
  50% {
    opacity: 0;
  }
}

@keyframes float {
  0% {
    transform: translateY(0) rotate(0deg);
  }
  25% {
    transform: translateY(-5px) rotate(-1deg);
  }
  50% {
    transform: translateY(0) rotate(0deg);
  }
  75% {
    transform: translateY(5px) rotate(1deg);
  }
  100% {
    transform: translateY(0) rotate(0deg);
  }
}

#gameLogo {
  width: 200px; /* Largura padr√£o */
  max-width: 80%; /* Garante que o logo seja responsivo */
  height: auto; /* Mant√©m a propor√ß√£o do logo */
  margin-bottom: 20px; /* Espa√ßamento abaixo do logo */
  animation: float 4s ease-in-out infinite; /* Aplica a anima√ß√£o */
}

#loadingScreen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #ff4081;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5em;
  z-index: 1000;
}

.spinner {
  width: 50px;
  height: 50px;
  border: 5px solid rgba(255, 255, 255, 0.3);
  border-top: 5px solid white;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 20px;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}


.modal {
  display: none; /* Escondido por padr√£o */
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8); /* Fundo escuro transl√∫cido */
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.modal-content {
  background: white;
  color: #333;
  padding: 20px;
  border-radius: 12px;
  text-align: center;
  width: 80%;
  max-width: 300px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

.modal-content button {
  margin-top: 15px;
}

#tutorialModal .modal-content {
  text-align: left; /* Alinha o texto √† esquerda */
}

#tutorialModal h2 {
  font-size: 1.5em;
  margin-bottom: 10px;
}

#tutorialModal p {
  font-size: 1em;
  margin: 8px 0;
  line-height: 1.5;
}

#nameModal input {
  font-size: 1em;
  text-align: center;
}
  </style>
</head>
<body ontouchstart="">
  <div id="loadingScreen"><div class="spinner"></div>Carregando...</div>
  <div class="animated-background"></div>

  <!-- Telas -->
  <div id="menuScreen" class="active">
    <img src="./assets/logo.png" alt="Acerte o cora√ß√£o da Thay" id="gameLogo">
    <button class="button primary-button" onclick="startGame()">Iniciar Jogo</button>
    <button class="button secondary-button" onclick="showTutorial()">Como Jogar</button>    <button class="button secondary-button" onclick="getRanking()">Ver Ranking</button>
    <button class="button secondary-button" onclick="showCredits()">Cr√©ditos</button>

  </div>

  <div id="gameScreen">
    <div id="statsBox">
      <div class="stat">
        <span class="label">Pontos</span>
        <span id="score" class="value">0</span>
      </div>
      <div class="stat">
        <span class="label">Tempo</span>
        <span id="timer" class="value">30</span>
      </div>
    </div>
    <div id="gameArea"></div>
  </div>

  <div id="customModal" class="modal">
    <div class="modal-content">
      <span id="modalText"></span>
      <button id="modalButton" class="button primary-button">OK</button>
    </div>
  </div>
  <div id="nameModal" class="modal">
    <div class="modal-content">
      <h2>Digite seu nome</h2>
      <input type="text" id="playerNameInput" placeholder="" style="width: 80%; padding: 10px; margin: 10px 0; border-radius: 8px; border: 1px solid #ccc;">
      <button id="saveNameButton" class="button primary-button">Salvar</button>
    </div>
  </div>

  <div id="gameOverScreen">
    <div id="resultContainer">
      <div id="finalScoreDisplay">0</div>
      <img id="thayImage" src="" alt="Thay apaixonada">
      <div id="loveLevelDisplay"></div>
    </div>
    <button id="menuButton" class="button secondary-button" onclick="goToMenu()">Voltar ao Menu</button>
  </div>

  <div id="tutorialModal" class="modal">
    <div class="modal-content">
      <h2>Como Jogar</h2>
      <p>üíñ Clique nos cora√ß√µes para ganhar pontos</p>
      <p>üí© Clicar no coc√¥ √© foda. Perde ponto.</p>
      <p>‚ùÑÔ∏è Power up! Neve congela o tempo por 5 segundos</p>
      <p>üíõ Super cora√ß√£o te d√° 5 pontos</p>
      <p>‚è∞ <strong>Voc√™ tem 30 segundos para conquistar o cora√ß√£o da Thay</strong></p>
      <button id="closeTutorialButton" class="button primary-button">Voltar</button>
    </div>
  </div>

  <audio id="bgMusic" loop>
    <source src="https://www.bensound.com/bensound-music/bensound-love.mp3" type="audio/mp3">
  </audio>

  <audio id="clickSound">
    <source src="./assets/click.mp3" type="audio/mp3">
  </audio>

  <audio id="voz1">
    <source src="./assets/awn.mp3" type="audio/mp3">
  </audio>
  <audio id="voz2">
    <source src="./assets/que-linda.mp3" type="audio/mp3">
  </audio>

  <script>
document.addEventListener("DOMContentLoaded", () => {
  const SUPABASE_URL = "https://wkhuahnayminyjmpweig.supabase.co";
  const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndraHVhaG5heW1pbnlqbXB3ZWlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYyNTYzMzYsImV4cCI6MjA2MTgzMjMzNn0.AV_fZoLgl5GggmV5Vu7-N8CK9KzIjMu4bpCh0RAO0pY";
  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  // Fun√ß√£o para enviar pontua√ß√£o
  window.submitScore = async function (name, score) {
  console.log("Enviando pontua√ß√£o:", { name, score });

  // Verifica se o jogador j√° existe na tabela
  const { data: existingPlayer, error: fetchError } = await supabase
    .from("scores")
    .select("*")
    .eq("name", name)
    .single();

  if (fetchError && fetchError.code !== "PGRST116") {
    console.error("Erro ao buscar jogador:", fetchError.message);
    showModal("Erro ao salvar pontua√ß√£o. Tente novamente.");
    return;
  }

  if (existingPlayer) {
    // Jogador j√° existe, atualiza a pontua√ß√£o apenas se for maior
    if (score > existingPlayer.score) {
      const { error: updateError } = await supabase
        .from("scores")
        .update({ score })
        .eq("name", name);

      if (updateError) {
        console.error("Erro ao atualizar pontua√ß√£o:", updateError.message);
        showModal("Erro ao atualizar pontua√ß√£o. Tente novamente.");
      } else {
        console.log("Pontua√ß√£o atualizada com sucesso!");
        showModal("Pontua√ß√£o atualizada com sucesso! üèÜ");
      }
    } else {
      showModal("Sua pontua√ß√£o n√£o superou a anterior. üòÖ");
    }
  } else {
    // Jogador n√£o existe, insere um novo registro
    const { error: insertError } = await supabase
      .from("scores")
      .insert([{ name, score }]);

    if (insertError) {
      console.error("Erro ao inserir pontua√ß√£o:", insertError.message);
      showModal("Erro ao salvar pontua√ß√£o. Tente novamente.");
    } else {
      console.log("Pontua√ß√£o salva com sucesso!");
      showModal("Pontua√ß√£o salva com sucesso! üéâ");
    }
  }
};

  // Fun√ß√£o para obter o ranking
  window.getRanking = async function () {
  console.log("Obtendo ranking...");
  const { data, error } = await supabase
    .from("scores")
    .select("name, score")
    .order("score", { ascending: false })
    .limit(10);

  if (error) {
    console.error("Erro ao obter ranking:", error.message);
    showModal("Erro ao obter ranking. Tente novamente.");
    return;
  }

  console.log("Ranking recebido:", data);

  // Gera o conte√∫do do ranking
  let rankingContent = `
    <h2>Ranking Global</h2>
    <ol style="text-align: left; padding-left: 20px;">
      ${data
        .map(
          (entry, index) =>
            `<li><strong>${index + 1}.</strong> ${entry.name} - <span style="color: #ff4081;">${entry.score} pontos</span></li>`
        )
        .join("")}
    </ol>
  `;

  // Exibe o ranking no modal
  showModal(rankingContent);
};
});

async function updatePlayerStats(playerId, score, timePlayed) {
  const { data, error } = await supabase
    .from("stats")
    .select("*")
    .eq("player_id", playerId)
    .single();

  if (error) {
    console.error("Erro ao buscar estat√≠sticas:", error.message);
    return;
  }

  //stats
  const stats = data || { games_played: 0, high_score: 0, total_time_played: 0 };
  stats.games_played++;
  stats.high_score = Math.max(stats.high_score, score);
  stats.total_time_played += timePlayed;

  const { error: updateError } = await supabase
    .from("stats")
    .upsert({ ...stats, player_id: playerId });

  if (updateError) {
    console.error("Erro ao atualizar estat√≠sticas:", updateError.message);
  } else {
    console.log("Estat√≠sticas atualizadas:", stats);
  }
}

//conquistas
async function saveAchievement(playerId, achievementName) {
  const { data, error } = await supabase
    .from("achievements")
    .insert([{ player_id: playerId, achievement_name: achievementName }]);

  if (error) {
    console.error("Erro ao salvar conquista:", error.message);
  } else {
    console.log("Conquista salva:", data);
  }
}



window.addEventListener("load", () => {
  const loadingScreen = document.getElementById("loadingScreen");
  if (loadingScreen) {
    loadingScreen.style.display = "none"; // Oculta a tela de carregamento
  }
});

    let score = 0;
    let timeLeft = 30;
    let gameInterval;
    let heartInterval;
    let hueShift = 0;

    const frases = [
      "Voc√™ √© meu ponto fraco üò≥",
      "Mais um e meu cora√ß√£o √© seu üíò",
      "T√¥ ficando boba com isso üòç",
      "Ai ai... üíì",
      "Voc√™ sabe que eu te adoro, n√©?",
      "Assim voc√™ me ganha! üòö",
      "N√£o para n√£o üíû",
      "Voc√™ t√° me fazendo ficar vermelha! üò≥",
      "Cora√ß√£o acelerado! üíì",
      "Cora√ß√£ozinho batendo forte! üíì",

    ];

    const menuScreen = document.getElementById("menuScreen");
    const gameScreen = document.getElementById("gameScreen");
    const gameOverScreen = document.getElementById("gameOverScreen");
    const scoreDisplay = document.getElementById("score");
    const timerDisplay = document.getElementById("timer");
    const finalScoreDisplay = document.getElementById("finalScore");
    const loveLevel = document.getElementById("loveLevel");
    const gameArea = document.getElementById("gameArea");
    const bgMusic = document.getElementById("bgMusic");
    const clickSound = document.getElementById("clickSound");

    function startGame() {
      score = 0;
      timeLeft = 30;
      hueShift = 0;
      scoreDisplay.textContent = "0";
      timerDisplay.textContent = "30";
      menuScreen.classList.remove("active");
      gameOverScreen.classList.remove("active");
      gameScreen.classList.add("active");
      bgMusic.volume = 0.2;
      bgMusic.play().catch(() => {}); // iOS fix

      gameInterval = setInterval(updateTimer, 1000);
      heartInterval = setInterval(spawnHeart, 800);
      for (let i = 0; i < 10; i++) createFloatingHeart();
    }


    function updateTimer() {
  timeLeft--;
  timerDisplay.textContent = `‚è∞ ${timeLeft}`;

  // Adiciona a classe 'blink' quando faltam 3 segundos ou menos
  if (timeLeft <= 5) {
    timerDisplay.classList.add("blink");
  } else {
    timerDisplay.classList.remove("blink"); // Remove o efeito se o tempo for maior que 3
  }

  if (timeLeft <= 0) {
    endGame();
  }
}

    function spawnHeart() {
      const heart = document.createElement("div");
      heart.classList.add("heart");
      heart.style.top = Math.floor(Math.random() * 490) + "px";
      heart.style.left = Math.floor(Math.random() * 310) + "px";
      heart.style.filter = `hue-rotate(${hueShift}deg)`;

      heart.addEventListener("click", () => {
        score++;
        scoreDisplay.textContent = score;
        heart.remove();
        clickSound.play();
    // Toca som especial em cora√ß√µes aleat√≥rios
    if (Math.random() < 0.5) { // 50% de chance
      const voice = Math.random() < 0.5 ? document.getElementById("voz1") : document.getElementById("voz2");
      voice.play();
    }

    messageBubble(frases[Math.floor(Math.random() * frases.length)]);
    hueShift += 40;
  });

      gameArea.appendChild(heart);

      setTimeout(() => {
        if (heart.parentElement) heart.remove();
      }, 1500);
    }

    function createFloatingHeart() {
      const float = document.createElement("div");
      float.classList.add("floating-heart");
      float.style.left = Math.floor(Math.random() * 360) + "px";
      float.style.bottom = "-20px";
      gameArea.appendChild(float);
      setTimeout(() => float.remove(), 6000);
    }

    
    function spawnFreezePowerUp() {
  const freeze = document.createElement("div");
  freeze.textContent = "‚ùÑÔ∏è"; // Emoji de congelar
  freeze.style.position = "absolute";
  freeze.style.fontSize = "3em";
  freeze.style.top = Math.floor(Math.random() * 490) + "px";
  freeze.style.left = Math.floor(Math.random() * 310) + "px";
  freeze.style.cursor = "pointer";
  freeze.style.zIndex = "10";
  freeze.style.animation = "pulse 1.2s infinite"; // Anima√ß√£o para destacar o power-up

  freeze.addEventListener("click", () => {
    clearInterval(gameInterval); // Pausa o cron√¥metro
    messageBubble("O tempo foi congelado por 5 segundos! ‚ùÑÔ∏è");
    setTimeout(() => {
      gameInterval = setInterval(updateTimer, 1000); // Retoma o cron√¥metro ap√≥s 5 segundos
    }, 5000);
    freeze.remove(); // Remove o power-up ap√≥s o clique
  });

  gameArea.appendChild(freeze);

  // Remove o power-up ap√≥s 5 segundos se n√£o for clicado
  setTimeout(() => {
    if (freeze.parentElement) freeze.remove();
  }, 5000);
}

// Faz o power-up aparecer raramente (a cada 20 segundos, por exemplo)
setInterval(() => {
  if (Math.random() < 0.2) spawnFreezePowerUp(); // 20% de chance de aparecer
}, 20000);

  function spawnPoop() {
    const poop = document.createElement("div");
    poop.textContent = "üí©";
    poop.style.position = "absolute";
    poop.style.fontSize = "2.5em";
    poop.style.top = Math.floor(Math.random() * 490) + "px";
    poop.style.left = Math.floor(Math.random() * 310) + "px";
    poop.style.cursor = "pointer";
    poop.style.zIndex = "10";
    poop.style.animation = "pulse 1.2s infinite"; // Add the same animation as the heart

    // Decrease score when the poop is clicked
    poop.addEventListener("click", () => {
      score--;
      scoreDisplay.textContent = score;
      poop.remove();
      clickSound.play(); // Optional: Play the same click sound
    });

    gameArea.appendChild(poop);

    // Remove the poop after 2 seconds if not clicked
    setTimeout(() => {
      if (poop.parentElement) poop.remove();
    }, 2000);
  }

  // Modify the startGame function to spawn poops periodically
  function startGame() {
    score = 0;
    timeLeft = 30;
    hueShift = 0;
    scoreDisplay.textContent = "0";
    timerDisplay.textContent = "30";
    menuScreen.classList.remove("active");
    gameOverScreen.classList.remove("active");
    gameScreen.classList.add("active");
    bgMusic.volume = 0.2;

    // Fix for iOS autoplay restrictions
    bgMusic.play().catch(() => {
      const playButton = document.createElement("button");
      playButton.textContent = "Tocar M√∫sica üéµ";
      playButton.style.position = "absolute";
      playButton.style.top = "10px";
      playButton.style.left = "50%";
      playButton.style.transform = "translateX(-50%)";
      playButton.style.zIndex = "1000";
      playButton.addEventListener("click", () => {
        bgMusic.play();
        playButton.remove();
      });
      document.body.appendChild(playButton);
    });

    gameInterval = setInterval(updateTimer, 1000);
    heartInterval = setInterval(spawnHeart, 800);
    setInterval(spawnPoop, 3000); // Spawn a poop every 3 seconds
    for (let i = 0; i < 10; i++) createFloatingHeart();
  }


  const poopFrases = [
    "Eca! üí©",
    "Isso n√£o √© um cora√ß√£o! üòñ",
    "Cuidado onde clica! ü§¢",
    "Que nojo! üí©",
    "Voc√™ perdeu pontos! üòî",
    "N√£o era isso que voc√™ queria, n√©? üòÖ"
  ];

  function spawnPoop() {
    const poop = document.createElement("div");
    poop.textContent = "üí©";
    poop.style.position = "absolute";
    poop.style.fontSize = "2.5em";
    poop.style.top = Math.floor(Math.random() * 490) + "px";
    poop.style.left = Math.floor(Math.random() * 310) + "px";
    poop.style.cursor = "pointer";
    poop.style.zIndex = "10";
    poop.style.animation = "pulse 1.2s infinite"; // Add the same animation as the heart

    // Decrease score when the poop is clicked
    poop.addEventListener("click", () => {
      score--;
      scoreDisplay.textContent = score;
      poop.remove();
      clickSound.play(); // Optional: Play the same click sound
      messageBubble(poopFrases[Math.floor(Math.random() * poopFrases.length)]); // Show a random poop phrase
    });

    gameArea.appendChild(poop);

    // Remove the poop after 2 seconds if not clicked
    setTimeout(() => {
      if (poop.parentElement) poop.remove();
    }, 2000);
  }

  function spawnSuperHeart() {
  const superHeart = document.createElement("div");
  superHeart.textContent = "üíõ";
  superHeart.style.position = "absolute";
  superHeart.style.fontSize = "3em";
  superHeart.style.top = Math.floor(Math.random() * 490) + "px";
  superHeart.style.left = Math.floor(Math.random() * 310) + "px";
  superHeart.style.cursor = "pointer";
  superHeart.style.zIndex = "10";
  superHeart.style.animation = "pulse 1.2s infinite";

  superHeart.addEventListener("click", () => {
    score += 5;
    scoreDisplay.textContent = score;
    superHeart.remove();
    clickSound.play();
    messageBubble("Voc√™ ganhou 5 pontos! üåü");
  });

  gameArea.appendChild(superHeart);

  setTimeout(() => {
    if (superHeart.parentElement) superHeart.remove();
  }, 3000);
}

setInterval(spawnSuperHeart, 10000); // Aparece a cada 10 segundos

function vibrate() {
  if (navigator.vibrate) {
    navigator.vibrate(100); // Vibra por 100ms
  }
}

// Exemplo: Vibra√ß√£o ao clicar em um cora√ß√£o
heart.addEventListener("click", () => {
  vibrate();
});
function endGame() {
  clearInterval(gameInterval);
  clearInterval(heartInterval);
  gameScreen.classList.remove("active");
  gameOverScreen.classList.add("active");

  // Atualiza a pontua√ß√£o final
  const finalScoreDisplay = document.getElementById("finalScoreDisplay");
  finalScoreDisplay.textContent = score; // Exibe a pontua√ß√£o corretamente

  // Solicita o nome do jogador usando o modal
  showNameModal(async (playerName) => {
    const playerId = await getPlayerId(playerName); // Obt√©m o ID do jogador
    await submitScore(playerName, score); // Salva no ranking
    await updatePlayerStats(playerId, score, 30); // Atualiza as estat√≠sticas (30 segundos de jogo)

    // Salva conquistas com base na pontua√ß√£o
  if (score >= 10) await saveAchievement(playerId, "Primeiro Cora√ß√£o");
  if (score >= 50) await saveAchievement(playerId, "Maratona de Amor");
  });



 

  // Define a Thay correspondente
  const thayImage = document.getElementById("thayImage");
  if (score < 10) {
    thayImage.src = "./assets/thay_0.png"; // N√≠vel t√≠mido
  } else if (score < 20) {
    thayImage.src = "./assets/thay_1.png"; // N√≠vel aquecendo os cora√ß√µes
  } else if (score < 30) {
    thayImage.src = "./assets/thay_2.png"; // N√≠vel apaixonada
  } else {
    thayImage.src = "./assets/thay_3.png"; // N√≠vel quer casar
  }

  // Define o n√≠vel de amor
  const loveLevelDisplay = document.getElementById("loveLevelDisplay");
  loveLevelDisplay.textContent = getLoveLevel(score); // Exibe o n√≠vel de amor

  // Limpa a √°rea do jogo
  gameArea.innerHTML = "";

  // Salva o recorde se for maior
  saveHighScore();
}

    function getLoveLevel(score) {
      if (score < 10) return "N√≠vel de amor: üíî t√≠mido ainda...";
      if (score < 20) return "N√≠vel de amor: üíó t√° aquecendo os cora√ß√µes!";
      if (score < 30) return "N√≠vel de amor: üíñ apaixonou a Thay!";
      return "N√≠vel de amor: üíò Thay quer casar contigo!";
    }

    function messageBubble(text) {
      const bubble = document.createElement("div");
      bubble.textContent = "Thay: " + text;
      bubble.style.position = "absolute";
      bubble.style.bottom = "10px";
      bubble.style.left = "50%";
      bubble.style.transform = "translateX(-50%)";
      bubble.style.background = "rgba(255,255,255,0.8)";
      bubble.style.color = "#000";
      bubble.style.padding = "8px 14px";
      bubble.style.borderRadius = "12px";
      bubble.style.fontSize = "1em";
      bubble.style.zIndex = "999";
      gameScreen.appendChild(bubble);
      setTimeout(() => bubble.remove(), 2000);
    }


    function saveHighScore() {
  const highScore = localStorage.getItem("highScore") || 0;
  if (score > highScore) {
    localStorage.setItem("highScore", score);
    showModal("Novo recorde! üèÜ");
  }
}

function showHighScore() {
  const highScore = localStorage.getItem("highScore") || 0;
  showModal("Recorde atual: " + highScore + " pontos! üèÖ");
}
    function goToMenu() {
      gameOverScreen.classList.remove("active");
      menuScreen.classList.add("active");
    }

    function showCredits() {
      showModal("Feito com amor por Hannah üíñ");
    }


    function showModal(message, callback) {
  const modal = document.getElementById("customModal");
  const modalText = document.getElementById("modalText");
  const modalButton = document.getElementById("modalButton");

  modalText.innerHTML = message; // Substitua textContent por innerHTML
  modal.style.display = "flex";

  modalButton.onclick = () => {
    modal.style.display = "none";
    if (callback) callback(); // Executa uma fun√ß√£o opcional ap√≥s fechar o modal
  };
}

function showNameModal(callback) {
  const nameModal = document.getElementById("nameModal");
  const playerNameInput = document.getElementById("playerNameInput");
  const saveNameButton = document.getElementById("saveNameButton");

  nameModal.style.display = "flex";

  saveNameButton.onclick = () => {
    const playerName = playerNameInput.value.trim();
    if (playerName) {
      nameModal.style.display = "none";
      callback(playerName); // Passa o nome para a fun√ß√£o de callback
    } else {
      alert("Por favor, insira um nome v√°lido.");
    }
  };
}

function showTutorial() {
  const tutorialModal = document.getElementById("tutorialModal");
  const closeTutorialButton = document.getElementById("closeTutorialButton");

  tutorialModal.style.display = "flex";

  closeTutorialButton.onclick = () => {
    tutorialModal.style.display = "none";
  };

  // Fecha o modal automaticamente ap√≥s 30 segundos
  setTimeout(() => {
    tutorialModal.style.display = "none";
  }, 30000);
}
  </script>
</body>
</html>
